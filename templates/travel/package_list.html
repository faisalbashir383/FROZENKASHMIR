{% extends 'travel/base.html' %}

{% block title %}Kashmir Tour Packages - All Inclusive Kashmir Holiday Deals | Frozen Kashmir{% endblock %}

{% block meta_description %}Explore our complete collection of Kashmir tour packages. Choose from honeymoon packages,
family tours, adventure trips, skiing holidays, and luxury tours. Best Kashmir packages with transparent pricing,
flexible itineraries, and 24/7 support.{% endblock %}

{% block meta_keywords %}Kashmir tour packages list, all Kashmir packages, Kashmir honeymoon deals, Kashmir family tour
packages, Kashmir adventure packages, best Kashmir tour deals, Kashmir skiing packages, Gulmarg ski packages, Kashmir
trekking packages, Kashmir winter packages 2025, Kashmir summer packages, Kashmir budget packages, Kashmir luxury tours,
Kashmir premium packages, affordable Kashmir tours, cheap Kashmir packages, Kashmir group tour packages, Kashmir private
tours, Kashmir customized packages, Kashmir weekend packages, Kashmir 3 day packages, Kashmir 4 day packages, Kashmir 5
day packages, Kashmir 7 day packages, Kashmir 10 day tours, Kashmir short trips, Kashmir long vacations, Kashmir tour
with flight, Kashmir tour with hotel, Kashmir all inclusive package, Kashmir package with meals, Kashmir package with
transport, Kashmir Deluxe package, Kashmir standard package, Kashmir economy tour, Kashmir super deluxe tour, Kashmir
VVIP package, Kashmir celebrity tour, Kashmir influencer packages, Kashmir photography packages, Kashmir solo traveler
packages, Kashmir couple tour packages, Kashmir senior citizen tour, Kashmir student tour packages, Kashmir corporate
tour, Kashmir conference packages, Kashmir team outing, Kashmir incentive tour, Kashmir wellness packages, Kashmir
Ayurveda tour, Kashmir meditation retreat, Kashmir yoga packages, Kashmir spiritual tour, Kashmir Sufi tour, Kashmir
heritage packages, Kashmir culture tour, Kashmir food tour package, Kashmir local experience, authentic Kashmir
packages, offbeat Kashmir tour, hidden gems Kashmir, unexplored Kashmir tour, Kashmir special tour, Kashmir festival
packages, Kashmir Tulip festival tour, Kashmir Shikara packages, Kashmir houseboat packages, Kashmir resort packages,
Kashmir tent stay packages, Kashmir camping packages, Kashmir glamping tours{% endblock %}

{% block content %}
<section class="section">
    <!-- Recommendations Section -->
    <!--    {% if recommendations %}-->
    <!--    <div class="recommendations-section">-->
    <!--        <div class="recommendations-header">-->
    <!--            <span style="font-size: 2rem;">‚ú®</span>-->
    <!--            <h3>Recommended for You</h3>-->
    <!--        </div>-->
    <!--        <div class="grid">-->
    <!--            {% for package in recommendations %}-->
    <!--            <div class="card">-->
    <!--                <div class="card-img-wrapper">-->
    <!--                    <span class="card-badge">Recommended</span>-->
    <!--                    {% if package.image %}-->
    <!--                    <img src="{{ package.image.url }}" alt="{{ package.title }}" class="card-img">-->
    <!--                    {% else %}-->
    <!--                    <div class="card-img"-->
    <!--                        style="background-color: #ddd; display: flex; align-items: center; justify-content: center;">No-->
    <!--                        Image</div>-->
    <!--                    {% endif %}-->
    <!--                </div>-->
    <!--                <div class="card-content">-->
    <!--                    <h3 class="card-title">{{ package.title }}</h3>-->
    <!--                    <div class="card-meta">-->
    <!--                        <span>‚è± {{ package.duration }}</span>-->
    <!--                        <span>üìç {{ package.destination.name }}</span>-->
    <!--                    </div>-->
    <!--                    <div class="price-row">-->
    <!--                        <div class="price">-->
    <!--                            ‚Çπ{{ package.price }}-->
    <!--                            <small>/ person</small>-->
    <!--                        </div>-->
    <!--                        <a href="{% url 'package_detail' package.slug %}" class="btn-outline"-->
    <!--                            style="padding: 0.5rem 1.2rem; font-size: 0.9rem;">View Details</a>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--            </div>-->
    <!--            {% endfor %}-->
    <!--        </div>-->
    <!--    </div>-->
    <!--    {% endif %}-->

    <h2 class="section-title">All Packages</h2>

    <!-- Mobile Filter Toggle -->
    <button class="mobile-filter-toggle" onclick="toggleFilters()">
        <span>‚öôÔ∏è</span> Filters & Sort
    </button>

    <div class="filter-container">
        <!-- Filter Sidebar -->
        <aside class="filter-sidebar" id="filterSidebar">
            <button class="close-filters d-lg-none" onclick="toggleFilters()">√ó</button>

            <form method="GET" action="{% url 'package_list' %}" id="filterForm">
                <!-- Preserve existing params -->
                {% if request.GET.sort %}<input type="hidden" name="sort" value="{{ request.GET.sort }}">{% endif %}

                <div class="filter-group">
                    <div class="filter-title">Price Range</div>
                    <div class="price-inputs">
                        <div class="price-input-group">
                            <span>‚Çπ</span>
                            <input type="number" name="min_price" placeholder="Min" value="{{ request.GET.min_price }}">
                        </div>
                        <div class="price-input-group">
                            <span>‚Çπ</span>
                            <input type="number" name="max_price" placeholder="Max" value="{{ request.GET.max_price }}">
                        </div>
                    </div>
                </div>

                <div class="filter-group">
                    <div class="filter-title">Category</div>
                    <div class="filter-options">
                        {% for code, name in categories %}
                        <label class="checkbox-label">
                            <input type="radio" name="category" value="{{ code }}" {% if request.GET.category == code %}checked{% endif %}>
                            {{ name }}
                        </label>
                        {% endfor %}
                    </div>
                </div>

                <div class="filter-group">
                    <div class="filter-title">Difficulty</div>
                    <div class="filter-options">
                        {% for code, name in difficulties %}
                        <label class="checkbox-label">
                            <input type="radio" name="difficulty" value="{{ code }}" {% if request.GET.difficulty == code %}checked{% endif %}>
                            {{ name }}
                        </label>
                        {% endfor %}
                    </div>
                </div>

                <div class="filter-group">
                    <div class="filter-title">Activities</div>
                    <div class="filter-options">
                        <label class="checkbox-label">
                            <input type="checkbox" name="activities" value="skiing" {% if 'skiing' in request.GET.activities %}checked{% endif %}>
                            Skiing
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="activities" value="trekking" {% if 'trekking' in request.GET.activities %}checked{% endif %}>
                            Trekking
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="activities" value="houseboat" {% if 'houseboat' in request.GET.activities %}checked{% endif %}>
                            Houseboat Stay
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="activities" value="sightseeing" {% if 'sightseeing' in request.GET.activities %}checked{% endif %}>
                            Sightseeing
                        </label>
                    </div>
                </div>

                <button type="submit" class="btn" style="width: 100%; margin-top: 1rem;">Apply Filters</button>
                <a href="{% url 'package_list' %}" class="btn-outline"
                    style="width: 100%; margin-top: 0.5rem; text-align: center; border: none;">Clear Filters</a>
            </form>
        </aside>

        <!-- Package Grid -->
        <div class="packages-content">
            <div class="packages-header">
                <div>
                    <strong>{{ packages.count }}</strong> packages found
                </div>
                <select class="sort-select" onchange="updateSort(this.value)">
                    <option value="popularity" {% if request.GET.sort == 'popularity' %}selected{% endif %}>Most Popular
                    </option>
                    <option value="price_low" {% if request.GET.sort == 'price_low' %}selected{% endif %}>Price: Low to
                        High</option>
                    <option value="price_high" {% if request.GET.sort == 'price_high' %}selected{% endif %}>Price: High to
                        Low</option>
                    <option value="duration" {% if request.GET.sort == 'duration' %}selected{% endif %}>Duration</option>
                    <option value="rating" {% if request.GET.sort == 'rating' %}selected{% endif %}>Top Rated</option>
                </select>
            </div>

            <div class="grid">
                {% for package in packages %}
                <div class="card">
                    <div class="card-img-wrapper">
                        <span class="card-badge">{{ package.get_category_display }}</span>
                        {% if package.image %}
                        <img src="{{ package.image.url }}" alt="{{ package.title }}" class="card-img">
                        {% else %}
                        <div class="card-img"
                            style="background-color: #ddd; display: flex; align-items: center; justify-content: center;">
                            No Image</div>
                        {% endif %}
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">{{ package.title }}</h3>
                        <div class="card-meta">
                            <span>‚è± {{ package.duration }}</span>
                            <span>üìç {{ package.destination.name }}</span>
                        </div>
                        <div class="card-meta">
                            <span>üí™ {{ package.get_difficulty_level_display }}</span>
                            <span>üë• Group: {{ package.group_size_min }}-{{ package.group_size_max }}</span>
                        </div>
                        <p style="color: #666; margin-bottom: 1rem; font-size: 0.95rem;">
                            {{package.overview|truncatewords:15 }}
                        </p>

                        {% if package.activities %}
                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                            {% for activity in package.get_activities_list|slice:":3" %}
                            <span
                                style="background: #f0f0f0; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; color: #555;">
                                {{activity }}
                            </span>
                            {% endfor %}
                        </div>
                        {% endif %}

                        <div class="price-row">
                            <div class="price">
                                ‚Çπ{{ package.price }}
                                <small>/ person</small>
                            </div>
                            <a href="{% url 'package_detail' package.slug %}" class="btn-outline"
                                style="padding: 0.5rem 1.2rem; font-size: 0.9rem;">View Details</a>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div
                    style="grid-column: 1/-1; text-align: center; padding: 3rem; background: #fff; border-radius: 16px;">
                    <h3>No packages found matching your criteria</h3>
                    <p>Try adjusting your filters or <a href="{% url 'package_list' %}"
                            style="color: var(--primary-color);">view all packages</a>.</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<script>
    function toggleFilters() {
        document.getElementById('filterSidebar').classList.toggle('active');
    }

    function updateSort(value) {
        const urlParams = new URLSearchParams(window.location.search);
        urlParams.set('sort', value);
        window.location.search = urlParams.toString();
    }
</script>
{% endblock %}